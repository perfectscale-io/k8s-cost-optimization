<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="https://assets-global.website-files.com/634ebd5aab79d1fa815c5394/637b3799370cfa67b276a970_PerfectScale%20-%20Favicon.png">
  <title>The Economics of Kubernetes Resource Allocation - Kubernetes Cost Optimization</title>
  <link rel="stylesheet" href="../css/w3.css">
  <link rel="stylesheet" href="../css/w3-theme.css" id="theme-auto">
  <link rel="stylesheet" href="../css/w3-theme-light.css" media="none" id="theme-light">
  <link rel="stylesheet" href="../css/w3-theme-dark.css" media="none" id="theme-dark">
  <link rel="stylesheet" href="../css/theme.css">
  <script>
  var base_url = "..";
  var themeItem = 'risonia_theme_'+encodeURIComponent('None');

  function checkTheme() {
    let theme = localStorage.getItem(themeItem);
    if (theme) {
      if (theme == 'light') {
        document.getElementById('theme-dark').media = 'none';
        document.getElementById('theme-light').media = '';
      }
      if (theme == 'dark') {
        document.getElementById('theme-light').media = 'none';
        document.getElementById('theme-dark').media = '';
      }
    }
  }
  checkTheme()
  </script>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-K8B2LNN');</script>
<!-- End Google Tag Manager -->

</head>

<body class="w3-theme-l5">

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="open-menu" viewBox="0 0 10 10" fill="currentColor">
    <rect y="0" width="10" height="2"/>
    <rect y="4" width="10" height="2"/>
    <rect y="8" width="10" height="2"/>
  </symbol>
  <symbol id="drop-down" viewBox="0 0 10 10" fill="currentColor">
    <path d="m2 1h6l-3 8z"/>
  </symbol>
  <symbol id="to-top" viewBox="0 0 10 10" fill="currentColor">
    <path d="m2 9h6l-3-8z" />
  </symbol>
  <symbol id="theme-toggle" viewBox="0 0 10 10">
    <ellipse cx="5" cy="5" rx="4.35" ry="4.35" fill="none" stroke="currentColor" stroke-width="1.2"/>
    <path d="M 5,0.5 A 4.5,4.5 0 0 1 9.5,5 4.5,4.5 0 0 1 5,9.5 V 5 Z" fill="currentColor"/>
  </symbol>
  <symbol id="close-menu" viewBox="0 0 10 10" fill="none" stroke="currentColor">
    <path d="m0.71 0.71 8.58 8.58" stroke-width="2"/>
    <path d="m9.29 0.71-8.58 8.58" stroke-width="2"/>
  </symbol>
  <symbol id="toc" viewBox="0 0 10 10" fill="none" stroke="currentColor" stroke-width="1.5">
    <path d="m2.75 1.25h6.75"/>
    <path d="m0.5 1.25h1.5"/>
    <path d="m5 6.13h4.5"/>
    <path d="m2.75 6.13h1.5"/>
    <path d="m2.75 3.87h6.75"/>
    <path d="m0.5 3.87h1.5"/>
    <path d="m2.75 8.75h6.75"/>
    <path d="m0.5 8.75h1.5"/>
  </symbol>
  <symbol id="search" viewBox="0 0 10 10" fill="none" stroke="currentColor">
    <ellipse cx="3.25" cy="3.25" rx="2.75" ry="2.75" fill="none"/>
    <path d="m5 5 4.65 4.65" fill="none"/>
  </symbol>
</svg>

<div id="myTop" class="w3-container w3-cell-row w3-top w3-theme w3-medium no-print" style="z-index:2;">
  <div class="w3-cell w3-cell-middle" style="width:0;">
    <button class="w3-button w3-theme-d1 w3-hover-theme w3-padding-small" onclick="w3_open()"><img src="https://assets-global.website-files.com/634ebd5aab79d1fa815c5394/637b3799370cfa67b276a970_PerfectScale%20-%20Favicon.png" class="svg-2em"></button>
  </div>
  <div class="w3-cell w3-cell-middle w3-padding-24" style="width:0;">
    <span style="height:2em;display:inline-block;padding:16px 0px;">&nbsp;</span>
  </div>
  <div class="w3-cell w3-cell-middle">
    <span class="w3-left" id="title-top">The Kubernetes Cost Optimization Guide</span>
  </div>
  <div class="w3-cell w3-cell-middle" style="width:0;">
    <button class="w3-button w3-theme-d1 w3-hover-theme w3-padding-small w3-left w3-hide no-print" onclick="topFunction()" id="myToTop"><svg class="svg-1em"><use xlink:href="#to-top" /></svg></button>
  </div>
  <div class="w3-cell w3-cell-middle">
    <button class="w3-button w3-theme-d1 w3-hover-theme w3-padding-small w3-right no-print" onclick="toggleTheme(themeItem)" id="myThemeToggle"><svg class="svg-1em"><use xlink:href="#theme-toggle" /></svg></button>
    <button class="w3-button w3-theme-d1 w3-hover-theme w3-padding-small w3-right no-print" onclick="openSearch()"><svg class="svg-1em"><use xlink:href="#search" /></svg></button>
    <a class="w3-button w3-theme-d1 w3-hover-theme w3-padding-small w3-right no-print" href="None" target="_blank">&lt;/&gt;</a>
    </div>
</div>

<header class="w3-container w3-theme w3-medium">
  <div class="w3-cell w3-cell-middle">
    <button class="w3-button w3-theme w3-hover-theme w3-padding-small" style="background-color: transparent!important;"><img src="https://assets-global.website-files.com/634ebd5aab79d1fa815c5394/637b3799370cfa67b276a970_PerfectScale%20-%20Favicon.png" class="svg-2em"></button>
  </div>
  <div class="w3-cell w3-cell-middle w3-padding-24" style="width:0;">
    <span style="height:2em;display:inline-block;padding:16px 0px;">&nbsp;</span>
  </div>
  <div class="w3-cell w3-cell-middle">
    <span class="w3-left" id="title-head">The Kubernetes Cost Optimization Guide</span>
  </div>
</header>
<nav class="w3-sidebar w3-bar-block w3-collapse-custom w3-animate-left w3-theme-l4" style="z-index:3;width:300px;" id="mySidebar">
  <div id="myNav" style="font-weight: bold;">
    <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" href="..">
      Home
    </a>
    <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" href="../golden-signals/">
      The Golden Signals of Kubernetes Cost Optimization
    </a>
    <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l2" href="./">
      The Economics of Kubernetes Resource Allocation
    </a>
    <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" href="../over-under-idle-waste/">
      The 4 Focus Areas of Kubernetes Cost Optimization
    </a>
    <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" href="../cost-perf-r9y/">
      Balancing Cost with Performance and Reliability
    </a>
    <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" href="../rightsizing/">
      Kubernetes Workload Rightsizing
    </a>
    <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" onclick="myAccordion('acc1')" href="javascript:void(0)">
      Pod Autoscaling<svg class="svg-1em"><use xlink:href="#drop-down" /></svg>
    </a>
    <div id="acc1" class="w3-animate-left w3-hide">
      <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" href="../pod-autoscaling/" style="padding-left: 24px;">
        Overview
      </a>
      <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" href="../hpa/" style="padding-left: 24px;">
        Horizontal Pod Autoscaling (HPA)
      </a>
      <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" href="../keda.md" style="padding-left: 24px;">
        Event Driven Autoscaling (KEDA)
      </a>
      <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" href="../vpa.md" style="padding-left: 24px;">
        Vertical Pod Autoscaling (VPA)
      </a>
    </div>
    <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" href="../cluster-autoscaling/">
      Cluster Autoscaling
    </a>
    <a class="w3-bar-item w3-padding-16 w3-button w3-hover-theme w3-theme-l4" href="../cloud-discounts/">
      Leveraging Cloud Discounts
    </a>
  </div>
  <div class="w3-container w3-large" style="height: 8em;" >&nbsp;</div>
</nav>

<div class="w3-overlay w3-hide-huge w3-animate-opacity" onclick="w3_close()" style="cursor:pointer;" id="myOverlay"></div>
    
<nav class="w3-sidebar w3-bar-block w3-collapse w3-animate-right w3-theme-l4" style="z-index:3;width:300px;right:0;" id="myTocbar">
  <div id="myToc">
  <a href="#the-economics-of-kubernetes-resource-allocation" class="w3-bar-item w3-button w3-hover-theme w3-theme-l4">The Economics of Kubernetes Resource Allocation</a>
    <a href="#resource-allocation-in-kubernetes" class="w3-bar-item w3-small w3-button w3-hover-theme w3-theme-l4">Resource Allocation in Kubernetes</a>
      <a href="#cpu-and-memory-allocation" class="w3-bar-item w3-small w3-button w3-hover-theme w3-theme-l4" style="padding-left: 24px;">CPU and memory allocation</a>
      <a href="#storage-resource-allocation" class="w3-bar-item w3-small w3-button w3-hover-theme w3-theme-l4" style="padding-left: 24px;">Storage Resource Allocation</a>
      <a href="#network-resource-allocation" class="w3-bar-item w3-small w3-button w3-hover-theme w3-theme-l4" style="padding-left: 24px;">Network Resource Allocation</a>
  </div>
  <div class="w3-container w3-large" style="height: 8em;" >&nbsp;</div>
</nav>

<div id="main-view" class="w3-main-custom" style="margin-left:300px; margin-right:300px;">

<div class="w3-container" style="padding: 32px;">
  <div class="w3-right w3-margin-bottom no-print">
    <div class="w3-dropdown-hover w3-hide-large" id="myTocButton" style="z-index:1;">
      <button class="w3-button w3-hover-theme w3-theme-l3 w3-hover-theme"><svg class="svg-1em"><use xlink:href="#toc" /></svg></button>
      <div class="w3-dropdown-content w3-bar-block" style="right:0;">
        <a href="#the-economics-of-kubernetes-resource-allocation" class="w3-bar-item w3-button w3-hover-theme w3-theme-l3">The Economics of Kubernetes Resource Allocation</a>
        <a href="#resource-allocation-in-kubernetes" class="w3-bar-item w3-small w3-button w3-hover-theme w3-theme-l3">Resource Allocation in Kubernetes</a>
          <a href="#cpu-and-memory-allocation" class="w3-bar-item w3-small w3-button w3-hover-theme w3-theme-l3" style="padding-left: 24px;">CPU and memory allocation</a>
          <a href="#storage-resource-allocation" class="w3-bar-item w3-small w3-button w3-hover-theme w3-theme-l3" style="padding-left: 24px;">Storage Resource Allocation</a>
          <a href="#network-resource-allocation" class="w3-bar-item w3-small w3-button w3-hover-theme w3-theme-l3" style="padding-left: 24px;">Network Resource Allocation</a>
      </div>
    </div>
  </div>
<h1 id="the-economics-of-kubernetes-resource-allocation">The Economics of Kubernetes Resource Allocation</h1>
<p>This whole guide talks a lot about <em>resources</em> which is a highly overloaded word in Kubernetes world. All the objects defined in Kubernetes API (such as Pod, Service, ConfigMap, etc) are also called <em>resources</em>. But we're not referring to them here.</p>
<p>So in order to make things clearer let's define resources for the purpose of this guide.</p>
<p>When we say <em>resources</em> - we actually mean CPU, GPU, memory, network and storage. </p>
<p>In the pre-cloud world all these needed to be defined in advance. Ordering and provisioning these resources took weeks or even months.</p>
<p>In cloud native environments (i.e Kubernetes) these resources are highly dynamic in nature and can be allocated and released on demand - just by issuing an API call. The process of allocating additional resources in such an automated manner is called autoscaling.
This automation gives us a lot of power by prividing access to addtional resources when needed (aka just-in-time provisioning). And it also creates undesirable artifacts if not configured correctly such as:</p>
<ul>
<li>Wasted resources (when we allocate more than we actually need)</li>
<li>Reliability issues (when provisioning doesn't work as expected)</li>
<li>Unexpected costs (when we don't have good control over what and when gets provisioned)</li>
</ul>
<h2 id="resource-allocation-in-kubernetes">Resource Allocation in Kubernetes</h2>
<p>Kubernetes has different ways of allocating, limiting and provisioning resources for application containers.</p>
<h3 id="cpu-and-memory-allocation">CPU and memory allocation</h3>
<p>On the very basic level - engineers can request CPU and memory for a container by defining its resource requests and limits in the Pod resource spec:</p>
<pre class="w3-code w3-responsive"><code class="language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
  - image: perfectscale.io/example
    name: example
    resources: 
      requests:
        cpu: 1
        memory: 500Mi
      limits:
        cpu: 1
        memory: 500Mi
</code></pre>
<h3 id="storage-resource-allocation">Storage Resource Allocation</h3>
<p>In order to allocate storage Kubernetes allows us to use its PersistentVolume allocation mechanisms in conjunction with one of the multiple supported storage providers (e.g OpenEBS, Portworx, etc.)</p>
<h3 id="network-resource-allocation">Network Resource Allocation</h3>
<p>Network resources aren't managed by Kubernetes itself but instead are delegated to one of the multiple CNI networking providers, which are reponsible for provisioning, allocating and retiring network interfaces and addresses. </p>
<p>Continue <a href="../over-under-idle-waste">here</a> to get a better understanding of the <a href="../over-under-idle-waste">4 main focus areas of Kubernetes Cost Optimization</a>.</p>
<div id="mkdocs_search_modal" class="w3-modal">
  <div class="w3-modal-content">
    <div class="w3-theme-l4">
      <span onclick="closeSearch();" class="w3-theme-l2 w3-button w3-hover-theme w3-display-topright"><svg class="svg-1em"><use xlink:href="#close-menu" /></svg></span>
      <span class="w3-display-topleft" style="padding: 8px 16px;"><svg class="svg-2em"><use xlink:href="#search" /></svg></span>
      <form id="content_search">
        <div class="w3-container">&nbsp;</div>
        <div class="w3-container">&nbsp;</div>
        <div class="w3-container">
          <input type="search" class="w3-input w3-border w3-round w3-theme-l5 w3-hover-theme" placeholder="" id="mkdocs-search-query">
        </div>
      </form>
      <div class="w3-container search-results" id="mkdocs-search-results" data-no-results-text="-">&nbsp;</div>
    </div>
  </div>
</div>
</div>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K8B2LNN" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <p class="w3-right w3-tiny">
    <a href="https://perfectscale.io">Brought to you by PerfectScale </a> <img src="https://assets-global.website-files.com/634ebd5aab79d1fa815c5394/637b3799370cfa67b276a970_PerfectScale%20-%20Favicon.png">
  </p>
</div>
<script src="../js/theme.js"></script>  
    <script src="../search/main.js"></script>
<script>
  var DOMContentLoaded_fired = false;
</script>
<script id="theme">
function runWhenDOMContentLoaded() {
  document.querySelectorAll('pre code').forEach((el) => {
    hljs.highlightElement(el);
  });
  document.querySelectorAll('table').forEach(function(table) {
    if (!table.hasAttribute('Tablesort')) {
      new Tablesort(table);
      table.setAttribute('Tablesort', '');
    }
  });
}
if (DOMContentLoaded_fired) {
  runWhenDOMContentLoaded();
}
</script>
<script>
document.addEventListener('DOMContentLoaded',function(){
  DOMContentLoaded_fired=true;
  runWhenDOMContentLoaded();
});
</script>

</body>
</html>
